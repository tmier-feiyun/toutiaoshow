(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-02347927"],{"0c00":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("发表文章")])]),a("div",{staticClass:"text item"},[a("el-form",{ref:"addFormRef",attrs:{"label-width":"120px",model:t.addForm,rules:t.addFormRules}},[a("el-form-item",{attrs:{label:"标题",prop:"title"}},[a("el-input",{attrs:{type:"text"},model:{value:t.addForm.title,callback:function(e){t.$set(t.addForm,"title",e)},expression:"addForm.title"}})],1),a("el-form-item",{attrs:{label:"内容",prop:"content"}},[a("quill-editor",{model:{value:t.addForm.content,callback:function(e){t.$set(t.addForm,"content",e)},expression:"addForm.content"}})],1),a("el-form-item",{attrs:{label:"封面"}},[a("el-radio-group",{model:{value:t.addForm.cover.type,callback:function(e){t.$set(t.addForm.cover,"type",e)},expression:"addForm.cover.type"}},[a("el-radio",{attrs:{label:0}},[t._v("无图")]),a("el-radio",{attrs:{label:1}},[t._v("单图")]),a("el-radio",{attrs:{label:3}},[t._v("三图")]),a("el-radio",{attrs:{label:-1}},[t._v("自动")])],1),a("ul",t._l(this.coverNum,(function(e){return a("li",{key:e,staticClass:"uploadbox",on:{click:function(a){return t.showDialog(e)}}},[a("span",[t._v("点击图标选择图片")]),t.addForm.cover.images[e-1]?a("img",{attrs:{src:t.addForm.cover.images[e-1],alt:""}}):a("div",{staticClass:"el-icon-picture-outline"})])})),0)],1),a("el-form-item",{attrs:{label:"频道: ",prop:"channel_id"}},[a("channel-com",{on:{slt:t.selectHandler}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addArticle(!1)}}},[t._v("发布")]),a("el-button",{attrs:{type:"warning"},on:{click:function(e){return t.ArticleDraft(!0)}}},[t._v("保存草稿")])],1)],1)],1),a("el-dialog",{attrs:{title:"封面管理",visible:t.dialogVisible,width:"60%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("ul",{staticClass:"clearfix"},t._l(t.imageList,(function(e){return a("li",{key:e.id,staticClass:"image-box"},[a("img",{attrs:{src:e.url,alt:"没有图片"},on:{click:t.clkImage}})])})),0),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.cancelSelection}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.imageOK}},[t._v("确 定")])],1)])],1)},r=[],s=(a("a753"),a("8096"),a("14e1"),a("953d")),o=a("59e7"),l={name:"ArticleAdd",created:function(){this.getImageList()},components:{quillEditor:s["quillEditor"],ChannelCom:o["a"]},computed:{coverNum:function(){return this.addForm.cover.type>0?this.addForm.cover.type:0}},data:function(){return{materialUrl:"",xu:"",imageList:[],querycdt:{collect:!1,page:1,per_page:20},dialogVisible:!1,addFormRules:{title:[{required:!0,message:"标题必须填写"},{min:5,max:30,message:"标题长度介于5-30个字符"}],content:[{required:!0,message:"内容必须填写"}],channel_id:[{required:!0,message:"频道必选"}]},addForm:{title:"",content:"",cover:{type:3,images:[]},channel_id:""}}},methods:{cancelSelection:function(){this.clearImage(),this.dialogVisible=!1},clearImage:function(){for(var t=document.querySelectorAll(".image-box"),e=0;e<t.length;e++)t[e].style.opacity=1,t[e].className="image-box";this.materialUrl=""},imageOK:function(){this.materialUrl?(this.addForm.cover.images[this.xu]=this.materialUrl,this.dialogVisible=!1,this.clearImage()):this.$message.error("抱歉，您还没有选择图片呢~")},clkImage:function(t){this.clearImage(),t.target.parentNode.style.opacity=.81,t.target.parentNode.classList.toggle("duihao"),this.materialUrl=t.target.src},getImageList:function(){var t=this,e=this.$http.get("/user/images",{params:this.querycdt});e.then((function(e){"OK"===e.data.message&&(t.imageList=e.data.data.results)})).catch((function(e){return t.$message.error("获取图片失败: "+e)}))},showDialog:function(t){this.xu=t-1,this.dialogVisible=!0},selectHandler:function(t){this.addForm.channel_id=t},addArticle:function(t){var e=this;this.$confirm("确认发布?","发布提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$refs.addFormRef.validate((function(a){if(a){var i=e.$http.post("/articles",e.addForm,{params:{draft:t}});i.then((function(t){201===t.status&&(e.$message.success("发布成功~"),e.$router.push("/article"))})).catch((function(t){return e.$message.error("发表文章失败"+t)}))}}))})).catch((function(){e.$message({type:"info",message:"已取消发布"})}))},ArticleDraft:function(t){var e=this;this.$refs.addFormRef.validate((function(a){if(a){var i=e.$http.post("/articles",e.addForm,{params:{draft:t}});i.then((function(t){201===t.status&&(e.$message.success("保存草稿成功~"),e.$router.push("/article"))})).catch((function(t){return e.$message.error("保存草稿失败"+t)}))}}))}}},n=l,c=(a("beee"),a("2877")),d=Object(c["a"])(n,i,r,!1,null,"cf47e630",null);e["default"]=d.exports},"56f9":function(t,e,a){},beee:function(t,e,a){"use strict";var i=a("56f9"),r=a.n(i);r.a}}]);
//# sourceMappingURL=chunk-02347927.2babe3c5.js.map